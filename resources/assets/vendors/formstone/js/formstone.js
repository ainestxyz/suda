!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(jQuery)}(function(e){"use strict";var t,n,r,i="undefined"!=typeof window?window:this,a=i.document,s=function(){this.Version="1.4.18",this.Plugins={},this.DontConflict=!1,this.Conflicts={fn:{}},this.ResizeHandlers=[],this.RAFHandlers=[],this.window=i,this.$window=e(i),this.document=a,this.$document=e(a),this.$body=null,this.windowWidth=0,this.windowHeight=0,this.fallbackWidth=1024,this.fallbackHeight=768,this.userAgent=window.navigator.userAgent||window.navigator.vendor||window.opera,this.isFirefox=/Firefox/i.test(this.userAgent),this.isChrome=/Chrome/i.test(this.userAgent),this.isSafari=/Safari/i.test(this.userAgent)&&!this.isChrome,this.isMobile=/Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(this.userAgent),this.isIEMobile=/IEMobile/i.test(this.userAgent),this.isFirefoxMobile=this.isFirefox&&this.isMobile,this.transform=null,this.transition=null,this.support={file:!!(window.File&&window.FileList&&window.FileReader),history:!!(window.history&&window.history.pushState&&window.history.replaceState),matchMedia:!(!window.matchMedia&&!window.msMatchMedia),pointer:!!window.PointerEvent,raf:!(!window.requestAnimationFrame||!window.cancelAnimationFrame),touch:!!("ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch),transition:!1,transform:!1}},o={killEvent:function(e,t){try{e.preventDefault(),e.stopPropagation(),t&&e.stopImmediatePropagation()}catch(e){}},killGesture:function(e){try{e.preventDefault()}catch(e){}},lockViewport:function(n){h[n]=!0,e.isEmptyObject(h)||m||(t.length?t.attr("content",r):t=e("head").append('<meta name="viewport" content="'+r+'">'),l.$body.on(d.gestureChange,o.killGesture).on(d.gestureStart,o.killGesture).on(d.gestureEnd,o.killGesture),m=!0)},unlockViewport:function(r){"undefined"!==e.type(h[r])&&delete h[r],e.isEmptyObject(h)&&m&&(t.length&&(n?t.attr("content",n):t.remove()),l.$body.off(d.gestureChange).off(d.gestureStart).off(d.gestureEnd),m=!1)},startTimer:function(e,t,n,r){return o.clearTimer(e),r?setInterval(n,t):setTimeout(n,t)},clearTimer:function(e,t){e&&(t?clearInterval(e):clearTimeout(e),e=null)},sortAsc:function(e,t){return parseInt(e,10)-parseInt(t,10)},sortDesc:function(e,t){return parseInt(t,10)-parseInt(e,10)},decodeEntities:function(e){var t=l.document.createElement("textarea");return t.innerHTML=e,t.value},parseQueryString:function(e){for(var t={},n=e.slice(e.indexOf("?")+1).split("&"),r=0;r<n.length;r++){var i=n[r].split("=");t[i[0]]=i[1]}return t}},l=new s,u=e.Deferred(),c={base:"{ns}",element:"{ns}-element"},d={namespace:".{ns}",beforeUnload:"beforeunload.{ns}",blur:"blur.{ns}",change:"change.{ns}",click:"click.{ns}",dblClick:"dblclick.{ns}",drag:"drag.{ns}",dragEnd:"dragend.{ns}",dragEnter:"dragenter.{ns}",dragLeave:"dragleave.{ns}",dragOver:"dragover.{ns}",dragStart:"dragstart.{ns}",drop:"drop.{ns}",error:"error.{ns}",focus:"focus.{ns}",focusIn:"focusin.{ns}",focusOut:"focusout.{ns}",gestureChange:"gesturechange.{ns}",gestureStart:"gesturestart.{ns}",gestureEnd:"gestureend.{ns}",input:"input.{ns}",keyDown:"keydown.{ns}",keyPress:"keypress.{ns}",keyUp:"keyup.{ns}",load:"load.{ns}",mouseDown:"mousedown.{ns}",mouseEnter:"mouseenter.{ns}",mouseLeave:"mouseleave.{ns}",mouseMove:"mousemove.{ns}",mouseOut:"mouseout.{ns}",mouseOver:"mouseover.{ns}",mouseUp:"mouseup.{ns}",panStart:"panstart.{ns}",pan:"pan.{ns}",panEnd:"panend.{ns}",resize:"resize.{ns}",scaleStart:"scalestart.{ns}",scaleEnd:"scaleend.{ns}",scale:"scale.{ns}",scroll:"scroll.{ns}",select:"select.{ns}",swipe:"swipe.{ns}",touchCancel:"touchcancel.{ns}",touchEnd:"touchend.{ns}",touchLeave:"touchleave.{ns}",touchMove:"touchmove.{ns}",touchStart:"touchstart.{ns}"},f=null,p=20,h=[],m=!1;function g(e,t,n,r){var i,a={raw:{}};for(i in r=r||{})r.hasOwnProperty(i)&&("classes"===e?(a.raw[r[i]]=t+"-"+r[i],a[r[i]]="."+t+"-"+r[i]):(a.raw[i]=r[i],a[i]=r[i]+"."+t));for(i in n)n.hasOwnProperty(i)&&("classes"===e?(a.raw[i]=n[i].replace(/{ns}/g,t),a[i]=n[i].replace(/{ns}/g,"."+t)):(a.raw[i]=n[i].replace(/.{ns}/g,""),a[i]=n[i].replace(/{ns}/g,t)));return a}function w(){l.windowWidth=l.$window.width(),l.windowHeight=l.$window.height(),f=o.startTimer(f,p,v)}function v(){for(var e in l.ResizeHandlers)l.ResizeHandlers.hasOwnProperty(e)&&l.ResizeHandlers[e].callback.call(window,l.windowWidth,l.windowHeight)}function y(e,t){return parseInt(e.priority)-parseInt(t.priority)}return s.prototype.NoConflict=function(){for(var t in l.DontConflict=!0,l.Plugins)l.Plugins.hasOwnProperty(t)&&(e[t]=l.Conflicts[t],e.fn[t]=l.Conflicts.fn[t])},s.prototype.Ready=function(e){"complete"===l.document.readyState||"loading"!==l.document.readyState&&!l.document.documentElement.doScroll?e():l.document.addEventListener("DOMContentLoaded",e)},s.prototype.Plugin=function(t,n){return l.Plugins[t]=function(t,n){var r="fs-"+t,i="fs"+t.replace(/(^|\s)([a-z])/g,function(e,t,n){return t+n.toUpperCase()});function a(e){return e.data(i)}return n.initialized=!1,n.priority=n.priority||10,n.classes=g("classes",r,c,n.classes),n.events=g("events",t,d,n.events),n.functions=e.extend({getData:a,iterate:function(t){for(var n=Array.prototype.slice.call(arguments,1),r=0,i=this.length;r<i;r++){var s=this.eq(r),o=a(s)||{};"undefined"!==e.type(o.$el)&&t.apply(s,[o].concat(n))}return this}},o,n.functions),n.methods=e.extend(!0,{_construct:e.noop,_postConstruct:e.noop,_destruct:e.noop,_resize:!1,destroy:function(e){n.functions.iterate.apply(this,[n.methods._destruct].concat(Array.prototype.slice.call(arguments,1))),this.removeClass(n.classes.raw.element).removeData(i)}},n.methods),n.utilities=e.extend(!0,{_initialize:!1,_delegate:!1,defaults:function(t){n.defaults=e.extend(!0,n.defaults,t||{})}},n.utilities),n.widget&&(l.Conflicts.fn[t]=e.fn[t],e.fn[i]=function(r){if(this instanceof e){var s=n.methods[r];if("object"===e.type(r)||!r)return function(r){var s,o,l,u="object"===e.type(r),c=Array.prototype.slice.call(arguments,u?1:0),d=e();for(r=e.extend(!0,{},n.defaults||{},u?r:{}),o=0,l=this.length;o<l;o++)if(!a(s=this.eq(o))){n.guid++;var f="__"+n.guid,p=n.classes.raw.base+f,h=s.data(t+"-options"),m=e.extend(!0,{$el:s,guid:f,numGuid:n.guid,rawGuid:p,dotGuid:"."+p},r,"object"===e.type(h)?h:{});s.addClass(n.classes.raw.element).data(i,m),n.methods._construct.apply(s,[m].concat(c)),d=d.add(s)}for(o=0,l=d.length;o<l;o++)s=d.eq(o),n.methods._postConstruct.apply(s,[a(s)]);return this}.apply(this,arguments);if(s&&0!==r.indexOf("_")){var o=[s].concat(Array.prototype.slice.call(arguments,1));return n.functions.iterate.apply(this,o)}return this}},l.DontConflict||(e.fn[t]=e.fn[i])),l.Conflicts[t]=e[t],e[i]=n.utilities._delegate||function(t){var r=n.utilities[t]||n.utilities._initialize||!1;if(r){var i=Array.prototype.slice.call(arguments,"object"===e.type(t)?0:1);return r.apply(window,i)}},l.DontConflict||(e[t]=e[i]),n.namespace=t,n.namespaceClean=i,n.guid=0,n.methods._resize&&(l.ResizeHandlers.push({namespace:t,priority:n.priority,callback:n.methods._resize}),l.ResizeHandlers.sort(y)),n.methods._raf&&(l.RAFHandlers.push({namespace:t,priority:n.priority,callback:n.methods._raf}),l.RAFHandlers.sort(y)),n}(t,n),l.Plugins[t]},l.$window.on("resize.fs",w),w(),function e(){if(l.support.raf)for(var t in l.window.requestAnimationFrame(e),l.RAFHandlers)l.RAFHandlers.hasOwnProperty(t)&&l.RAFHandlers[t].callback.call(window)}(),l.Ready(function(){l.$body=e("body"),e("html").addClass(l.support.touch?"touchevents":"no-touchevents"),t=e('meta[name="viewport"]'),n=!!t.length&&t.attr("content"),r="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0",u.resolve()}),d.clickTouchStart=d.click+" "+d.touchStart,function(){var e,t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"otransitionend",transition:"transitionend"},n=["transition","-webkit-transition"],r={transform:"transform",MozTransform:"-moz-transform",OTransform:"-o-transform",msTransform:"-ms-transform",webkitTransform:"-webkit-transform"},i="transitionend",a="",s="",o=document.createElement("div");for(e in t)if(t.hasOwnProperty(e)&&e in o.style){i=t[e],l.support.transition=!0;break}for(e in d.transitionEnd=i+".{ns}",n)if(n.hasOwnProperty(e)&&n[e]in o.style){a=n[e];break}for(e in l.transition=a,r)if(r.hasOwnProperty(e)&&r[e]in o.style){l.support.transform=!0,s=r[e];break}l.transform=s}(),window.Formstone=l,l}),function(e){"function"==typeof define&&define.amd?define(["jquery","./core"],e):e(jQuery,Formstone)}(function(e,t){"use strict";function n(e,t,n){t.error=!0,e.$el.trigger(b.fileError,[t,n]),e.aborting||h(e)}function r(e){e.disabled&&(this.removeClass(y.disabled),e.$input.prop("disabled",!1),e.disabled=!1)}function i(e){k.killEvent(e);var t=e.data;t.disabled||t.$input.trigger(b.click)}function a(e){e.data.$el.addClass(y.focus)}function s(e){e.data.$el.removeClass(y.focus)}function o(e){k.killEvent(e);var t=e.data,n=t.$input[0].files;!t.disabled&&n.length&&f(t,n)}function l(e){k.killEvent(e),e.data.$el.addClass(y.dropping).trigger(b.fileDragEnter)}function u(e){k.killEvent(e),e.data.$el.addClass(y.dropping).trigger(b.fileDragOver)}function c(e){k.killEvent(e),e.data.$el.removeClass(y.dropping).trigger(b.fileDragLeave)}function d(e){k.killEvent(e);var t=e.data,n=e.originalEvent.dataTransfer.files;t.$el.removeClass(y.dropping),t.disabled||f(t,n)}function f(e,t){var n=[],r=t.length;if(e.maxFiles){var i=e.maxFiles-e.uploaded;i>=0&&t.length>i&&(r=i)}if(r>0){for(var a=0;a<r;a++){var s={index:e.total++,file:t[a],name:t[a].name,size:t[a].size,started:!1,complete:!1,error:!1,transfer:null};n.push(s),e.queue.push(s)}e.$el.trigger(b.queued,[n]),e.autoUpload&&p(e)}e.$input.val("")}function p(e){e.uploading||(C.on(b.beforeUnload,function(){return e.leave}),e.uploading=!0,e.$el.trigger(b.start,[e.queue])),h(e)}function h(e){var t=0,n=[];if(e.uploading){for(var r in e.queue)!e.queue.hasOwnProperty(r)||e.queue[r].complete||e.queue[r].error||n.push(e.queue[r]);for(var i in e.queue=n,e.queue)if(e.queue.hasOwnProperty(i)){if(e.queue[i].started||m(e,e.queue[i]),++t>=e.maxConcurrent)return;r++}0===t&&(C.off(b.beforeUnload),e.uploading=!1,e.$el.trigger(b.complete))}}function m(t,r){if(r.size>=t.maxSize||!0===r.error)n(t,r,"size");else if(t.chunked)r.started=!0,r.chunkSize=1024*t.chunkSize,r.totalChunks=Math.ceil(r.size/r.chunkSize),r.currentChunk=0,t.$el.trigger(b.fileStart,[r]),function t(r,i){var a=i.chunkSize*i.currentChunk,s=a+i.chunkSize;s>i.size&&(s=i.size);var o=i.file[S](a,s),l=new FormData;l.append(r.postKey,o,i.file.name);l.append("chunks",i.totalChunks);l.append("chunk",i.currentChunk);l=g(r,l,i);!1===l?n(r,i,"abort"):i.chunkTransfer=e.ajax({url:r.action,data:l,dataType:r.dataType,headers:r.headers,type:"POST",contentType:!1,processData:!1,cache:!1,beforeSend:function(e,t){r.$el.trigger(b.chunkStart,[i,t,e])},success:function(e,n,a){i.currentChunk++,r.$el.trigger(b.chunkComplete,[i]);var s=Math.ceil(i.currentChunk/i.totalChunks*100);r.$el.trigger(b.fileProgress,[i,s,n,a]),i.currentChunk<i.totalChunks?t(r,i):(i.complete=!0,r.$el.trigger(b.fileComplete,[i,e,n,a]),h(r))},error:function(e,t,a){!function(e,t,r){e.$el.trigger(b.chunkError,[t,r]),n(e,t,r)}(r,i,a)}})}(t,r);else{var i=new FormData;i.append(t.postKey,r.file),!1===(i=g(t,i,r))?n(t,r,"abort"):(r.started=!0,r.transfer=e.ajax({url:t.action,data:i,dataType:t.dataType,headers:t.headers,type:"POST",contentType:!1,processData:!1,cache:!1,xhr:function(){var n=e.ajaxSettings.xhr();return n.upload&&n.upload.addEventListener("progress",function(e){var n=0,i=e.loaded||e.position,a=e.total;e.lengthComputable&&(n=Math.ceil(i/a*100)),t.$el.trigger(b.fileProgress,[r,n,e])},!1),n},beforeSend:function(e,n){t.$el.trigger(b.fileStart,[r,n,e])},success:function(e,n,i){r.complete=!0,t.uploaded++,t.$el.trigger(b.fileComplete,[r,e,n,i]),h(t)},error:function(e,i,a){n(t,r,a)}}))}}function g(e,t,n){for(var r in e.postData)e.postData.hasOwnProperty(r)&&t.append(r,e.postData[r]);return t=e.beforeSend.call(e.$el,t,n)}var w=t.Plugin("upload",{widget:!0,defaults:{accept:!1,action:"",autoUpload:!0,beforeSend:function(e){return e},chunked:!1,chunkSize:100,customClass:"",dataType:"html",headers:{},label:"Drag and drop files or click to select",leave:"You have uploads pending, are you sure you want to leave this page?",maxConcurrent:2,maxFiles:!1,maxSize:5242880,multiple:!0,postData:{},postKey:"file",theme:"fs-light"},classes:["input","target","multiple","dropping","disabled","focus"],methods:{_construct:function(e){if(t.support.file){var n="";S||(e.chunked=!1),e.maxQueue&&(e.maxConcurrent=e.maxQueue),!1!==e.label&&(n+='<div class="'+y.target+'">',n+=e.label,n+="</div>"),n+='<input class="'+y.input+'" type="file"',e.multiple&&(n+=" multiple"),e.accept&&(n+=' accept="'+e.accept+'"'),n+=">",e.baseClasses=[y.base,e.theme,e.customClass].join(" "),this.addClass(e.baseClasses).append(n),e.$input=this.find(v.input),e.queue=[],e.total=0,e.uploaded=0,e.uploading=!1,e.disabled=!0,e.aborting=!1,this.on(b.click,v.target,e,i).on(b.dragEnter,e,l).on(b.dragOver,e,u).on(b.dragLeave,e,c).on(b.drop,e,d),e.$input.on(b.focus,e,a).on(b.blur,e,s).on(b.change,e,o),r.call(this,e)}},_destruct:function(e){t.support.file&&(e.$input.off(b.namespace),this.off(b.namespace).removeClass(e.baseClasses).html(""))},disable:function(e){e.disabled||(this.addClass(y.disabled),e.$input.prop("disabled",!0),e.disabled=!0)},enable:r,abort:function(t,r){var i;for(var a in t.aborting=!0,t.queue)t.queue.hasOwnProperty(a)&&(i=t.queue[a],("undefined"===e.type(r)||r>=0&&i.index===r)&&(i.started&&!i.complete?t.chunked?i.chunkTransfer.abort():i.transfer.abort():n(t,i,"abort")));t.aborting=!1,h(t)},start:p}}),v=w.classes,y=v.raw,b=w.events,k=w.functions,C=(t.window,t.$window),S=!1;t.Ready(function(){var e=["mozSlice","webkitSlice","slice"];if(t.support.file){var n=!1;try{n=new File([""],"f")}catch(e){}if(!n)try{n=new Blob([""],{})}catch(e){}if(n)for(var r in e)if(e.hasOwnProperty(r)&&e[r]in n){S=e[r];break}}}),b.chunkComplete="chunkcomplete",b.chunkError="chunkerror",b.chunkStart="chunkstart",b.complete="complete",b.fileComplete="filecomplete",b.fileDragEnter="filedragenter",b.fileDragLeave="filedragleave",b.fileDragOver="filedragover",b.fileError="fileerror",b.fileProgress="fileprogress",b.fileStart="filestart",b.start="start",b.queued="queued"});
